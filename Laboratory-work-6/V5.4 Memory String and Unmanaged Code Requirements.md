# V5.4 Пам'ять, рядки та некерований код

Наступні вимоги застосовуються лише тоді, коли програма використовує системну мову або некерований код.

| # | Description | L1 | L2 | L3 | CWE |
| - | - | - | - | - | - |
| 5.4.1 | Переконайтеся, що програма використовує безпечні для пам'яті рядки (*string*), безпечне копіювання пам'яті та арифметику з вказівниками для виявлення або запобігання переповненням стеку, буфера або купи (*heap*). | - | ✓ | ✓ | 120 |
| 5.4.2 | Переконайтеся, що рядки форматування (*format string*) не приймають потенційно небезпечних вхідних даних і є константами. | - | ✓ | ✓ | 134 |
| 5.4.3 | Переконайтеся, що методи перевірки знаків (*+, -*), діапазонів та вхідних даних використовуються для запобігання переповнень цілих чисел (*integer overflow*). | - | ✓ | ✓ | 190 |

# CWE-190: Переповнення чи круговий обхід цілого числа (integer overflow, integer wraparound)

## Опис

Продукт виконує обчислення, які можуть призвести до цілочисельного переповнення або обходу, коли логіка передбачає, що результуюче значення завжди буде більшим за початкове значення. Це може призвести до інших вразливостей, коли обчислення використовується для управління ресурсами або контролю виконання.

## Розширений опис

Цілочисельне переповнення або обхід виникає, коли ціле значення збільшується до значення, яке є занадто великим для зберігання у відповідному представленні. Коли це відбувається, значення може згорнутися і стати дуже малим або від'ємним числом. Хоча це може бути передбачуваною поведінкою за обставин, які покладаються на згортання, це може мати наслідки для безпеки, якщо згортання є непередбачуваним. Особливо це стосується випадків, коли цілочисельне переповнення може бути викликано за допомогою введень, наданих користувачем. Це стає критичним для безпеки, коли результат використовується для керування циклом, прийняття рішення щодо безпеки або визначення зсуву чи розміру у таких діях, як виділення пам'яті, копіювання, конкатенація тощо.

## Застосовується до платформ

### Мови

- Клас: Неспецифічний для мови (*невизначена поширеність*)

## Наслідки

| Область впливу | Сила впливу | Ймовірність |
| - | - | - |
| Доступність | Технічний вплив: DoS: Відмова, вихід або перезапуск; DoS: Споживання ресурсів (процесор); DoS: Споживання ресурсів (пам'ять); DoS: Нестабільність - Ця вразливість, як правило, призводить до невизначеної поведінки і, як наслідок, до збоїв. У випадку переповнень, пов'язаних з індексними змінними циклу, ймовірність нескінченних циклів також висока. | - |
| Цілісність | Технічний вплив: Модифікація пам'яті - Якщо значення, про яке йдеться, є важливим для даних (на відміну від потоку), відбувається просте пошкодження даних. Крім того, якщо обтікання призводить до інших умов, таких як переповнення буфера, може статися подальше пошкодження пам'яті. | - |
| Конфіденційність, Доступність, Контроль Доступу | Технічний вплив: Виконання несанкціонованого коду або команд; обхід механізму захисту - Ця вразливість іноді може спричинити переповнення буферу, що може бути використано для виконання довільного коду. Зазвичай це виходить за рамки неявної політики безпеки програми. | - |

# Ймовірність використання вразливості

Середня

# CWE-134: Використання рядка формату з зовнішнім керуванням

## Опис

Продукт використовує функцію, яка приймає рядок формату як аргумент, але рядок формату походить із зовнішнього джерела.

## Розширений опис

Коли зловмисник може модифікувати зовнішньо контрольований рядок формату, це може призвести до переповнення буфера, відмови в обслуговуванні або проблем з представленням даних.

Слід зазначити, що в деяких випадках, наприклад, при інтернаціоналізації, набір рядків формату контролюється ззовні за замовчуванням. Якщо джерелу цих рядків формату довіряють (наприклад, вони містяться лише у бібліотечних файлах, які може змінювати лише системний адміністратор), то зовнішній контроль сам по собі може не становити вразливості.

## Застосовується до платформ

### Мови

- C (*часта поширеність*)
- C++ (*часта поширеність*)
- Perl (*рідкісна поширеність*)

## Наслідки

| Область впливу | Сила впливу | Ймовірність |
| - | - | - |
| Конфіденційність | Технічний вплив: Читання пам'яті - Проблеми з форматними рядками дозволяють розкрити інформацію, що може значно спростити експлуатацію програми. | - |
| Цілісність, конфіденційність, доступність | Технічний вплив: Модифікація пам'яті; виконання несанкціонованого коду або команд - Проблеми з рядком форматування можуть призвести до виконання довільного коду. | - |

# Ймовірність використання вразливості

Середня

# CWE-120: копіювання буфера без перевірки розміру вводу ('класичне переповнення буфера')

## Опис

Програма копіює вхідний буфер у вихідний без перевірки того, що розмір вхідного буфера менший за розмір вихідного, що призводить до переповнення буфера.

## Розширений опис

Переповнення буфера виникає, коли програма намагається помістити в буфер більше даних, ніж він може вмістити, або коли вона намагається помістити дані в область пам'яті за межами буфера. Найпростішим типом помилки і найпоширенішою причиною переповнення буфера є "класичний" випадок, коли програма копіює буфер без обмеження обсягу копіювання. Існують і інші варіанти, але наявність класичного переповнення переконливо свідчить про те, що програміст не враховує навіть найпростіші засоби захисту.

## Застосовується до платформ

### Мови

- C (*невизначена поширеність*)
- C++ (*невизначена поширеність*)
- Клас: Assembly (*невизначена поширеність*)

## Наслідки

| Область впливу | Сила впливу | Ймовірність |
| - | - | - |
| Цілісність, Конфіденційність, Доступність | Технічний вплив: Модифікація пам'яті; виконання несанкціонованого коду або команд - Переповнення буфера часто можна використати для виконання довільного коду, який зазвичай знаходиться поза межами неявної політики безпеки продукту. Це часто може бути використано для підриву будь-якої іншої служби безпеки. | - |
| Доступність | Технічний вплив: Модифікація пам'яті; DoS: Відмова в обслуговуванні, вихід або перезавантаження; DoS: Споживання ресурсів (процесор) - Переповнення буфера зазвичай призводить до збоїв. Можливі й інші атаки, що призводять до відсутності доступності, в тому числі зациклення продукту. | - |

# Ймовірність використання вразливості

Висока
